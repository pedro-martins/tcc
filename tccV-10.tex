%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Universidade Federal de Santa Catarina             
% Biblioteca Universitária                     
%----------------------------------------------------------------------
% Exemplo de utilização da documentclass ufscThesis
%----------------------------------------------------------------------                                                           
% (c)2013 Roberto Simoni (roberto.emc@gmail.com)
%         Carlos R Rocha (cticarlo@gmail.com)
%         Rafael M Casali (rafaelmcasali@yahoo.com.br)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass{ufscThesis} % Definicao do documentclass ufscThesis	


%----------------------------------------------------------------------
% Pacotes usados especificamente neste documento
\usepackage{graphicx} % Possibilita o uso de figuras e gráficos
\usepackage{color}    % Possibilita o uso de cores no documento
\usepackage{listings}
%----------------------------------------------------------------------
% Comandos criados pelo usuário
\newcommand{\afazer}[1]{{\color{red}{#1}}} % Para destacar uma parte a ser trabalhada
\newcommand{\ABNTbibliographyname}{REFERÊNCIAS} % Necessário para abnTeX 0.8.2
%----------------------------------------------------------------------
% Identificadores do trabalho
% Usados para preencher os elementos pré-textuais
\instituicao[a]{Universidade Federal de Santa Catarina} % Opcional
\curso[o]{Ciências da Computação}
\documento[a]{Trabalho de conclusão de curso} % [o] para dissertação [a] para tese
\titulo{Proposta de um modelo autônomo para monitoramento de ambientes de computação em nuvem }
\subtitulo{} % Opcional
\autor{Pedro Henrique Pereira Martins}
\grau{Bacharel em Ciências da Computação}
\local{Florianópolis} % Opcional (Florianópolis é o padrão)
\data{22}{julho}{2016}
\orientador[Orientador\\Universidade Federal de Santa Catarina]{Prof. Dr. Carlos Becker Westphall}
\coorientador[Coorientador\\Universidade Federal de Santa Catarina]{Me. Rafael Weingärtner}
\coordenador[Coordenador\\Universidade Federal de Santa Catarina]{Prof. Dr. Carlos Becker Westphall}

\numerodemembrosnabanca{4} % Isso decide se haverá uma folha adicional
\orientadornabanca{nao} % Se faz parte da banca definir como sim
\coorientadornabanca{sim} % Se faz parte da banca definir como sim
\bancaMembroA{Profa. Dra. Carla Merkle Westphall\\Universidade Federal de Santa Catarina } %Nome do presidente da banca
%\bancaMembroB{Segundo membro\\Universidade ...}      % Nome do membro da Banca
%\bancaMembroC{Terceiro membro\\Universidade ...}     % Nome do membro da Banca
%\bancaMembroD{Quarto membro\\Universidade ...}       % Nome do membro da Banca
%\bancaMembroE{Quinto membro\\Universidade ...}       % Nome do membro da Banca
%\bancaMembroF{Sexto membro\\Universidade ...}        % Nome do membro da Banca
%\bancaMembroG{Sétimo membro\\Universidade ...}       % Nome do membro da Banca

\dedicatoria{Este trabalho é dedicado aos meus colegas de classe e aos meus queridos pais.}

\agradecimento{Inserir os agradecimentos aos colaboradores à execução do trabalho.}

\epigrafe{Texto da Epígrafe. Citação relativa ao tema do trabalho. É opcional. A epígrafe pode também aparecer na abertura de cada seção ou capítulo.}
{(Autor da epígrafe, ano)}

\textoResumo {Atualmente as ferramentas de orquestração de ambientes de computação em nuvem como Apache CloudStack, OpenStack e outras não possuem um módulo nativo de monitoramento do ambiente. Para monitorar o ambiente de computação em nuvem, são utilizadas normalmente extensões destas ferramentas ou outras aplicações como Nagios, Zenoss e outras que satisfazem parcialmente a necessidade de monitoramento. Contudo, estas ferramentas são incompletas ou possuem outros problemas como dados incorretos, violam as máquinas virtuais dos usuários (injetando scripts ou aplicações nas máquinas virtuais) além de possuírem um deficit de autonomia. Logo, os administradores do ambiente, precisam ficar monitorando constantemente o ambiente para conseguir configurar a ferramenta de monitoramento para se adequar ao ambiente monitorado. Esta proposta consiste em especificar e implementar uma plataforma autônoma para monitorar a infraestrutura de ambientes de computação em nuvem.
	Palavras-chave:}
\palavrasChave {Computação em nuvem. Monitoramento autônomo. Apache CloudStack. Plataforma de monitoramento.}

\textAbstract {Cloud computing orchestration tools such as Apache CloudStack, OpenS- tack and others do not have a comprehensive native monitoring module. To monitor the cloud environment we normally use plugins or applications such as Nagios, Zenoss, and others that satisfy partially the monito- ring needs. However, they are incomplete or have problems such as accuracy, intrusiveness ( injecting scripts or applications in the users virtual machine), and a lack of autonomy. Therefore system ad- ministrators have to constantly monitor and configure all of the aplications/plugins parameters to best fit the environment. The goal of this proposal is the specification and development of an autonomous monitoring platform for cloud computing infrastructure.}
\keywords {Cloud computing. Autonomous monitoring. Apache CloudStack. Monitoring Platform.}
\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

%----------------------------------------------------------------------
% Início do documento                                
\begin{document}
	\graphicspath{{C:/Users/Pedro Henrique/Desktop/modelo/figuras}}
	%--------------------------------------------------------
	% Elementos pré-textuais
	\capa  
	\folhaderosto[comficha] % Se nao quiser imprimir a ficha, é só não usar o parâmetro
	\folhaaprovacao
	%\paginadedicatoria
	%\paginaagradecimento
	%\paginaepigrafe
	\paginaresumo
	\paginaabstract
	%\pretextuais % Substitui todos os elementos pre-textuais acima
	\listadefiguras % as listas dependem da necessidade do usuário
	\listadetabelas 
	\listadeabreviaturas
	%\listadesimbolos
	\sumario
	%--------------------------------------------------------
	% Elementos textuais
	
	\chapter{Introdução}
	Computação em nuvem vem sendo cada vez mais utilizada devido ao seu modelo permitir um melhor aproveitamento dos recursos de hardware e software, acarretando em redução de custos, melhor eficiência energética, elasticidade, flexibilidade e disponibilidade de recursos por demanda \cite{armbrust2010view} e \cite{singh2011cm}.
	
	Com o aumento da demanda por serviços prestados pela nuvem, há um constante crescimento da infraestrutura de modo a atender a demanda \cite{singh2011cm} e \cite{weingartner2015cloud}. O crescimento constante dos ambientes da nuvem acaba aumentando a complexidade de sua gerência tornando esta inviável de ser realizada por administradores sem auxilio de ferramentas apropriadas \cite{weingartner2015cloud}, \cite{hall2012opportunities} e \cite{urgaonkar2002resource}. 
	\citeonline{kephart2003vision} apresentam um modelo de computação autônoma como uma solução para lidar com grandes ambientes computacionais heterogêneos e complexos como ambientes de computação em nuvem.
	
	\citeonline{kephart2003vision} definem um elemento autônomo constituinte de quatro (4) etapas, monitoramento, análise, planejamento e execução, onde cada etapa depende da anterior. Cada etapa é detalhada a seguir.
	\begin{itemize}
		\item Monitoramento: durante este processo são coletadas informações sobre os recursos alocados e utilizados. Este processo é realizado periodicamente de modo a criar um histórico de alocação e uso de recursos;
		\item Análise: após ter os dados coletados, são iniciados os processos de análise em busca de tendências de consumo e comportamento das cargas e problemas referentes a carga que competem por recursos no mesmo servidor físico;
		\item Planejamento: depois de identificar as tendências de comportamento das cargas do ambiente, e possíveis problemas de degradação de serviço, pode-se traçar ações de modo a evitar as degradações de serviço e viabilizar a otimização do ambiente;
		\item Execução: após ter traçado uma sequência de ações serem tomadas é necessário executar todas as ações que foram previamente planejadas de modo a buscar atender aos objetivos do sistema de gerenciamento.
	\end{itemize} 
	
	Os processos descritos anteriormente são executados constantemente, de modo que seja possível para o sistema de gerenciamento identificar o contexto em que se encontra e adaptar-se ao ambiente a ser gerenciado de modo a atender aos objetivos gerenciais.
	
	Uma das necessidades para se efetuar o monitoramento do uso de recursos de ambientes de nuvem se da para fins comerciais, como cobrança relativa a serviços prestados. O valor a ser cobrado pode ser acordado entre o usuário e o fornecedor de recursos da nuvem ou pode ser pré-definido pelo fornecedor \cite{aceto2012cloud}. Além disso, o monitoramento também pode ser usado para viabilizar técnicas de otimização e auxiliar numa melhor gerência dos ambientes de computação em nuvem. Para viabilizar tais otimizações é importante que o monitoramento forneça dados precisos e em tempo hábil sem afetar o funcionamento da nuvem \cite{aceto2012cloud} e \cite{viratanapanu2010demand}
	
	O monitoramento em tempo real da nuvem é desafiador. Deve-se levar em conta o grande número de serviços e usuários,  que torna a nuvem um ambiente com um grande volume de informação para ser coletada e analisada \cite{shao2010runtime} e \cite{clayman2010monitoring}. 
	
	Outro fator que contribui para a complexidade de monitorar os ambientes de nuvem é a heterogeneidade dos seus componentes. Ambientes de nuvem são constituídos de diferentes clusters de servidores, cada um com seus respectivos processadores, memória, placa de rede, periféricos e virtualizadores. Deste modo, é necessário implementar meios para monitorar cada um desses elementos distintos \cite{shao2010runtime}. Além disso, os elementos que compõem o ambiente de computação em nuvem, podem estar dispersos geograficamente, o que gera a necessidade de ter um sistema de monitoramento distribuído, com nodos colhendo informações em cada elemento e enviando para um repositório de dados.
	
	O processo de monitoramento pode vir a sobrecarregar os recursos da nuvem se não for devidamente implantado, sendo este um dos principais desafios para o monitoramento dos recursos  \cite{shao2010runtime} e \cite{clayman2010monitoring}. Além disso, após implantado o sistema de monitoramento, qualquer modificação necessária deve ser feita sem a necessidade de desligar ou reiniciar o ambiente \cite{clayman2010monitoring}.
	
	Problemas resultantes de um monitoramento mal sucedido são:
	\begin{itemize}
		\item {A queda de desempenho da nuvem devido a sobrecargas de processamento com monitoramento;}
		\item {Ações de gerência mal sucedidas devido a dados inconsistentes advindos do processo de monitoramento;}
		\item {Perda de dados e/ou obtenção de dados corrompidos durante o processo de atualização dos componentes de monitoramento.}
	\end{itemize}   
	
	Atualmente as ferramentas de orquestração de computação em nuvem (levantadas durante o desenvolvimento deste trabalho) em sua maioria não realizam ou realizam mas não armazenam de modo histórico os dados resultantes do monitoramento dos recursos utilizados. O que estas ferramentas costumam adotar é o monitoramento momentâneo do ambiente para indicar aos administradores o estado corrente deste, sem a criação de um histórico de uso dos recursos. 
	
	Hoje em dia, existem ferramentas que realizam o monitoramento e podem ser acopladas a ferramentas de orquestração, porém são de difícil instalação e dependentes de APIs (Interface de programação de aplicações) de dos orquestradores que não são completas pois não permitem o monitoramento de uma série de recursos físicos e algumas costumam apresentar dados inconsistentes com o ambiente, além de ser mais uma camada de software para gerenciar.
	
	O Zenoss \cite{zenoss2015} é um exemplo de ferramenta de monitoramento que apresentam alguns problemas. No caso do Zenoss, e sua extensão para monitoramento do CloudStack \cite{cloudstack2015}, o CloudStack ZenPack \cite{CSzenPack2015}, existe um problema no monitoramento de uso de memória do servidor físico. A ferramenta faz uma requisição do uso de memória para o Xen \cite{xenProject2015} e projeta o retorno como se fosse o uso total de memória das máquinas virtuais alocadas no servidor. O problema é que esta requisição do Xen, retorna apenas o uso de memória relativo ao \textit{dom0}. Deste modo o Zenoss acaba fornecendo dados de apenas uma máquina virtual específica e não do servidor monitorado como um todo, o que pode levar a decisões inconsistentes no momento de gerenciamento e otimização dos ambientes.
	
	É necessário fazer uso de boas técnicas de manipulação de dados devido ao grande volume de informações que podem ser monitoradas em ambientes de nuvem. A ferramenta de monitoramento necessita ser o menos invasiva possível, ou seja, ser invisível para os usuários de ambientes de computação em nuvem. Além disso, deve-se tratar a precisão das informações capturadas, os dados fornecidos devem condizer com o ambiente monitorado \cite{aceto2012cloud}. Quanto mais rápida as informações sobre o estado do ambiente forem disponibilizadas, mais eficientemente se conseguirá administrá-lo.
	
	\section{Motivação}
	O monitoramento é de fundamental importância para ambientes de nuvem, pois proporciona um melhor entendimento do estado em que o ambiente se encontra, do estado das aplicações que estão hospedadas, do uso/disponibilidade de recursos físicos do ambiente e também para determinar se os acordos de prestação de serviço estão sendo devidamente cumpridos.
	
	Como apresentado em \cite{aceto2013cloud}, existe uma carência de autonomia nas ferramentas de monitoramento atuais. Assim, toda vez que novos recursos são inseridos no ambiente, deve-se informar às ferramentas que tais recursos devem ser monitorados, quando o ideal era a ferramenta detectar e passar a monitorar os recursos autonomamente.
	
	Outro ponto sobre as ferramentas atuais, é que a proposta delas em sua maioria, é monitorar desde a parte de aplicação até o nível de infraestrutura. Com isso, as ferramentas de monitoramento acabam se tornando complexas, com uma instalação complicada e consumindo mais recursos do ambiente do que se fossem específicas para apenas um modelo de serviço de nuvem.
	
	Motivado pela carência de ferramentas de monitoramento  pouco intrusivas, autônomas, com foco apenas na infraestrutura de ambientes de computação em nuvem, compatível com as ferramentas de orquestração atuais e de fácil instalação. Surgiu o interesse no projeto de uma abordagem que supra a necessidade de monitoramento da infraestrutura da nuvem. Capacitando assim, que ferramentas como CloudStack, possam fornecer todo o suporte para o monitoramento da infraestrutura do ambiente de nuvem sem interferência nos serviços por ela já fornecidos de modo autônomo e sem configurações adicionais.     
	
	\chapter{Objetivos}
	Este capítulo irá tratar dos objetivos que este trabalho pretende alcançar.
	\section{Objetivos gerais}
	
	Este trabalho busca analisar o tema de monitoramento de ambientes de computação em nuvem e elementos autônomos, para poder então propor um modelo de monitoramento autônomo para ambientes de computação em nuvem que fornecem infraestrutura como serviço.
	\section{Objetivos específicos}
	
	\begin{itemize}
		\item Levantar trabalhos relacionados e fazer um estudo sobre monitoramento de ambientes de computação em nuvem;
		\item Definir um modelo para realização de monitoramento autônomo de um ambiente de nuvem que forneça infraestrutura como serviço;
		\item Criar um \textit{framework} a partir do modelo definido para viabilizar a implantação em ferramentas de orquestração de nuvem;
		\item Verificar o impacto que o \textit{framework} pode causar no ambiente de nuvem monitorado.
		
	\end{itemize}
	
	\chapter{Fundamentação}
	Neste capítulo são apresentados os conceitos e tecnologias utilizadas para o desenvolvimento deste trabalho.
	
	
	\section{Computação em Nuvem}
	A computação em nuvem é um modelo ubíquo, conveniente e de acesso compartilhado
	a recursos computacionais como servidores, armazenamento, aplicações e redes \cite{mell2011nist}. Estes recursos compartilhados podem ser rapidamente provisionados e liberados com um esforço mínimo de gestão ou interação com o provedor de serviços \cite{mell2011nist}.
	
	\subsection{Características}
	Em \cite{mell2011nist} são definidas como caracteristicas básicas de um ambiente de computação em nuvem: 
	\begin{enumerate}{
			\item Acesso aos recursos sob demanda - o usuário pode escolher quais serviços/componentes ele irá usar dentro do que é disponibilizado pela nuvem sem a necessidade de interação com administradores;
			
			\item Disponibilidade - ambientes de computação em nuvem devem estar sempre disponíveis para o usuário pela internet independente da plataforma de acesso ($tablet$, $smartphone$, $desktop$ e outros);
			
			\item Recursos compartilhados - os recursos físicos da nuvem devem poder atender diferentes usuários simultaneamente;
			
			\item Elasticidade - conforme um usuário solicita mais recursos, a nuvem deve alocar mais recursos para este usuário evitando a degradação dos serviços prestados, assim como se um usuário deixar de usar recursos, a nuvem pode remover recursos excedentes;
			
			\item Monitoramento de serviços - a nuvem deve ser capaz de monitorar o uso de recursos por cada serviço, proporcionando transparência  aos fornecedores e usuários do serviço.}
	\end{enumerate}
	\subsection{Modelos de serviço}
	\citeonline{mell2011nist} descrevem os modelos de serviço disponibilizados pela nuvem como sendo:
	
	\begin{enumerate}
		
		
		\item Software como serviço: o provedor de nuvem fornece uma aplicação final via rede para usuários. O usuário não tem controle algum sobre a infraestrutura que hospeda a aplicação ou da plataforma que a aplicação usa, ele apenas consegue usar a aplicação;
		
		\item Plataforma como serviço: são disponibilizadas diferentes plataformas para o usuário desenvolver e hospedar suas próprias aplicações. Neste nível o usuário tem controle total das aplicações, e pode configurar por completo a plataforma. O usuário não possui acesso a recursos do sistema operacional que hospeda a plataforma;
		
		\item Infraestrutura como serviço: a nuvem fornece toda a infraestrutura para o usuário, como processador, disco, memória e rede. Neste nível o usuário tem uma máquina virtual pronta para uso, ele define quais plataformas ele irá usar e quais aplicações ele irá executar em cada plataforma, porém o usuário não tem acesso e controle dos componentes físicos do ambiente.
		
		Cada modelo de nuvem descrito acima visa um público diferente com diferentes propósitos, o software como serviço visa mais usuários de aplicações. O modelo de plataforma como serviço procura atender os  desenvolvedores que usarão as plataformas para hospedar suas aplicações. Em contra partida, o modelo de fornecimento de infraestrutura como serviço tem como foco empresas que desenvolvem serviços e os hospedam na infraestrutura de ambientes de computação em nuvem para minimizar seus custos com infraestrutura. Este trabalho tem como foco ambientes de nuvem computacional que atuam fornecendo infraestrutura como serviço.
	\end{enumerate}
	
	\section{Virtualização}
	
	
	
	A virtualização é um processo que foi primeiramente desenvolvido pela IBM com intuito de particionar um \textit{mainframe} com alta capacidade computacional \cite{sahoo2010virtualization}.
	
	O processo de virtualização consiste na existência de um virtualizador que gerencia sistemas operacionais convidados e intermedeia toda a comunicação entre hardware e esses sistemas \cite{menasce2005virtualization}. Sistemas operacionais convidados são executados sobre o virtualizador como se fossem aplicações em um sistema operacional qualquer. Portanto os sistemas operacionais convidados, não possuem acesso direto aos dispositivos físicos.
	
	
	O uso da virtualização possibilita que os mesmos componentes de hardware suportem diferentes sistemas operacionais como sendo diversas unidades lógicas. Estas unidades lógicas em que o hardware é dividido são nomeadas de \textit{Virtual Machine} (VM), em português, máquina virtual. Os sistemas operacionais e aplicações dentro das máquinas virtuais enxergam esses ambientes como reais. Ao final do processo de virtualização, para o usuário final, ter uma máquina virtual ou uma máquina física não irá mudar sua experiência de uso do computador \cite{sahoo2010virtualization}.
	
	\subsection{Vantagens e desvantagens da virtualização} 
	
	
	A virtualização permite um melhor aproveitamento dos recursos de hardware disponíveis. Permite a alteração de peças de hardware sem a necessidade de parar o funcionamento das VMs por longos períodos, bastando migrar a VM para outro servidor físico. O custo alugar uma máquina virtual em um servidor de computação em nuvem é menor que manter uma máquina física equivalente. \cite{sahoo2010virtualization}. 
	
	Como problemas temos uma sobrecarga de processamento para gerenciar a inúmera quantidade de máquinas virtuais. O desenvolvimento de virtualizadores não é algo simples e é de grande importância ter redundância de hardwares pois se ocorrer defeito em um componente, todas as VMs vinculadas a tal componente serão penalizadas \cite{popek1974formal} .
	
	\subsection{Tipos de virtualização} 
	
	Nesta seção, serão discutidos os tipos de virtualizações segundo \cite{virtualization2010}, e suas principais características.
	
	\begin{itemize}
		
		\item{Virtualização por contêiner: este tipo de virtualização precisa de um sistema operacional base. Neste caso, o virtualizador irá criar instâncias virtuais do sistema operacional base, isoladas logicamente. Estas instâncias são nada mais que ponteiros para os endereços físicos das rotinas do sistema operacional base. Isto gera um problema que não existe nos outros tipos de virtualização, que é o fato de todas as aplicações das instâncias dividirem os mesmos endereços físicos para suas chamadas de sistema, com isso, se o sistema operacional base for sucetível a algum ataque, uma aplicação maliciosa pode danificar o sistema operacional base, e com isso, prejudicar todas as outras instâncias virtuais desse sistema. Esse tipo de virtualização consome menos memória que as demais, pois usa apenas uma instância física de sistema operacional. Neste tipo de virtualização, os clientes estão presos a criarem VMs exclusivamente do mesmo tipo do sistema operacional base;}
		
		\item{Virtualização do tipo 1: este tipo de virtualização executa diretamente sobre o hardware, neste caso o virtualizador irá gerar abstrações de hardware completas para poder hospedar um sistema operacional qualquer. Isto cria um consumo extra de memória, pois cada instância irá ter seu próprio sistema operacional em memória. Este tipo de virtualização, possui a melhor performance de uso do processador dentre os tipos aqui apresentados. Neste tipo de virtualização, os clientes podem escolher seus próprios sistemas operacionais para serem instaladas nas VMs;}
		
		
		\item{Virtualização do tipo 2: esta virtualização assim como a virtualização por contêiner, precisa de um sistema operacional como base. Porém nesse caso, o virtualizador irá emular um hardware que será usado pelas instâncias virtuais criadas. Isso possibilita que as instâncias tenham seus próprios sistemas operacionais independentemente de qual é o sistema operacional base. O virtualizador não tem acesso direto ao hardware, podendo assim ser um virtualizador mais simples que da virtualização do tipo 1, já que é o sistema operacional base que irá tratar da comunicação com o mesmo. Esse tipo de virtualização é um meio termo entre a virtualização do tipo 1 e por contêiner.  }
		
	\end{itemize}
	
	Cada tipo de virtualização possui vantagens e desvantagens. O tipo 1, é o mais complexo entre os tipos de virtualização e o com menor penalidade de processamento. O tipo 2 usa um sistema operacional nativo como base para o funcionamento do virtualizador, o que remove parte da complexidade do virtualizador, porém acaba prejudicando o desempenho devido a camada de software extra. A virtualização por contêiner é o tipo com menor uso de memória, porém ela amarra os usuários ao sistema operacional base onde é executado o virtualizador. 
	
	
	
	\subsection{Virtualizadores}
	
	O virtualizador é responsável pela gerência dos recursos de hardware e fornecimento desses recursos para as máquinas virtuais. O responsável de fato pela gerência, criação e destruição das máquinas virtuais, é o \textit{Virtual Machine Monitor} (VMM), em português, monitor de máquina virtual \cite{vmware2007}. Portanto, toda vez que uma VM é criada, antes, é criado um VMM, e este passa a gerenciar a VM, e destruí-la quando necessário. Logo, existe um VMM para cada VM.  
	
	O Xen \cite{xenProject2015} é um virtualizador do tipo 1 de código aberto disponibilizado pela Citrix \cite{citrix2015}, que da suporte as arquiteturas x86 \cite{x86}, x86 64 \cite{x8664}, IA32 \cite{IA32}, IA64 \cite{IA64} e PowerPC \cite{POWERPC}. 
	As VMs instanciadas com esse virtualizador, são denominadas de domínio sem privilégios (DomU) \cite{xenProject2015domu}, além disso, existe uma VM que cuida de todo o fluxo de entrada e saída de dados dos DomU, que é denominada de domínio de controle (Dom0) \cite{xenProject2015dom0}. 
	Além de intermediar o acesso a entrada e saída de dados dos DomU, o Dom0 também fornece uma série de comandos para destruir, criar ou modificar cada DomU. Esses comandos de gerência disponibilizados no Dom0, são nativos da biblioteca XL \cite{xenProject2015xl}, porém, são de difícil usabilidade. O Xapi \cite{xenProject2015xapi}, é uma abstração para esses comandos que torna mais simples o uso dos recursos de criação de VMs, clusters e migração de VMs entre servidores de um mesmo cluster.
	
	O KVM \cite{kvm2015} assim como o Xen, é um virtualizador do tipo 1 de código aberto. Suportado pela Red Hat \cite{redhat2015}, o KVM é uma extenção do kernel do linux que permite a criação e gerência de VMs. O KVM usa o QEMU \cite{qemu2015} para emular o hardware que as VMs instanciadas irão usar. Um dos diferenciais do KVM é o fato dele não se preocupar com a gestão de diferentes servidores presentes em cluster, não tendo assim, qualquer custo de processamento para gerência dos servidores em um cluster. Usar esta abordagem no controle dos clusters, torna o KVM dependente de uma ferramenta de orquestração que dê suporte a gerência de servidores dentro de um cluster.  
	
	O ESXi \cite{esxi2015} é um virtualizador de código fechado e licença gratuíta que foi desenvolvido pela VMware \cite{vmware2015}. Tem suporte apenas para arquiteturas x86 de 32 e 64 bits. É um virtualizador do tipo 1. Este virtualizador é usado no vSphere que é uma ferramenta de criação de ambientes de nuvem criada pela VMware. O ESXi só permite a migração de VMs para diferentes servidores em sua versão comercial.
	
	O LXC \cite{lxc2015} é um virtualizador por contêiner gratuito de código aberto suportado pela Canonical \cite{canonical2015}. O LXC da suporte para criação de instâncias de distribuições linux, logo este virtualizador suporta todas as arquiteturas suportadas pelo linux. Instâncias criadas pelo LXC não possuem privilégios de root. O LXC está no repositório de software de distribuições linux, a instalação dele é bem simples. 
	
	VirtualBox \cite{virtualbox2015} é um virtualizador de código aberto do tipo 2 mantido pela Oracle \cite{oracle2015}. Este virtualizador pode ser instalado em distribuições Windows, Linux, Macintosh, Solaris e da suporte para instâncias de Windows (NT 4.0, 2000, XP, Server 2003, Vista, Windows 7, Windows 8), DOS/Windows 3.x, Linux (2.4, 2.6 e 3.x), Solaris e OpenSolaris, OS/2, e OpenBSD.
	
	\begin{table}[h]
		\centering
		\small
		\caption{Comparação entre virtualizadores analizados}
		\label{my-label}
		\resizebox{\columnwidth}{!}{
			\begin{tabular}{|l|l|l|c|c|}
				\hline
				& Empresa Responsável & Arquiteturas Suportadas     & \multicolumn{1}{l|}{Tipo de virtualização} & \multicolumn{1}{l|}{Tipo de Licensa} \\ \hline
				Xen & Citrix Systems      & x86, x86-64, IA 64, PowerPC & 1                                          & Código aberto                              \\ \hline
				KVM       & Red Hat             & x86, x86-64, IA 64, PowerPC & 1                                          & Código aberto                              \\ \hline
				ESXi      & VMware              & x86, x86-64                 & 1                                          & Gratuita/Comercial                         \\ \hline
				LXC      &  Canonical               & x86, x86-64, IA 64, PowerPC                & Contêiner                                          & Código aberto                         \\ \hline
				VirtualBox      &  Oracle               & x86, x86-64, IA 64                & 2                                          & Código aberto                         \\ \hline
			\end{tabular}
		}
	\end{table}
	
	Dentre os virtualizadores analizados, será utilizado neste trabalho o Xen devido a ser um virtualizador de código aberto e suportado por uma comunidade amplamente ativa. O fato do Xen ter seu código aberto, possibilita que toda uma comunidade interaja e possa contribuir com melhorias tanto na documentação quanto em correções de \textit{bugs} e evolução de suas funcionalidades.
	
	\section{Orquestração de ambientes de computação em nuvem} 
	As ferramentas de orquestração na nuvem servem para abstrair do administrador toda a parte de interação com os virtualizadores, serviços de armazenamento, dispositivos de redes e outros. Permitindo que o administrador não precise de amplos conhecimentos nas tecnologias de virtualização, rede, armazenamento e outras utilizadas para se criar o ambiente de nuvem.
	
	Essas abstrações proporcionadas pelas ferramentas de orquestração tornam possível que o administrador da nuvem possa delimitar recursos físicos para cada usuário facilmente. Assim como também possibilita que usuários sem conhecimento nenhum de computação possam criar suas próprias máquinas virtuais.
	
	\subsection{Ferramentas de orquestração} 
	
	Seguindo a análise realizada no trabalho \cite{tccgabriel2015}, foram análizadas as seguintes ferramentas de orquestração para uso no decorrer deste trabalho.
	
	\begin{itemize}
		
		\item CloudStack: o cloudStack \cite{cloudstack2015} é uma ferramenta de orquestração de código aberto, suportada pela fundação Apache \cite{apache2015} e desenvolvida em java. O cloudStack da suporte para virtualizadores como KVM, VM-ware , Xen e Hyper-V \cite{hyper-v2015}. Esta ferramenta da suporte aos sistemas de arquivos iSCSI \cite{iscsi2015} e NFS \cite{nfs2015};
		
		\item Eucalyptus: o Eucalyptus \cite{eucalyptus2015}, assim como o CloudStack, é uma ferramenta de orquestração de ambientes de computação em nuvem de código aberto. Suportada pela HP \cite{hp2015} e desenvolvida em java e C. O Eucalyptus, usa o Walrus como sistema de arquivo e da suporte aos virtualizadores KVM, XenServer e VMware;  
		
		\item OpenStack: O OpenStack \cite{openstack2015}, da suporte aos mesmos virtualizadores que o CloudStack, é uma ferramenta de código aberto desenvolvida em Python. Suporta os sistemas de arquivo Swift e Cinder.  
		
	\end{itemize}
	
	\begin{table}[h]
		\centering
		\caption{Comparação entre ferramentas de orquestração analizadas}
		\label{orchestration}
		\small
		\begin{tabular}{|l|c|l|l|}
			\hline
			& \multicolumn{1}{l|}{Linguagem Suportada} & Sistema de Arquivos & Tipo de Licensa \\ \hline
			CloudStack & Java                                     & iSCSI , NFS         & Código aberto   \\ \hline
			OpenStack  & Python                                   & Swift , Cinder      & Código aberto   \\ \hline
			Eucalyptus & Java , C                                 & Walrus              & Código aberto   \\ \hline
		\end{tabular}
	\end{table}
	
	
	
	Dentre essas ferramentas de orquestração em nuvem, foi optado o uso do CloudStack devida a uma série de motivos, tais como:
	\begin{itemize}
		
		\item	Suportado por uma fundação e uma comunidade amplamente ativa;
		\item	Possui uma documentação detalhada;
		\item	É codificada em java que é uma linguagem de programação bem conhecida para futuras extensões;
		\item	Da suporte para sistemas de arquivos conhecidos, o que diminui o tempo que seria gasto com familiarizações com novos conceitos;
		\item	É uma ferramenta de código aberto, o que possibilita um melhor conhecimento da ferramenta e implantação de melhorias. 
		
	\end{itemize}
	
	
	\section{Monitoramento de ambientes de computação em nuvem} 
	
	Nesta seção, serão abordadas as dificuldades relacionadas ao monitoramento na nuvem, sua importância, as características que o monitoramento deve possuir e algumas ferramentas que realizam monitoramento de ambientes de computação em nuvem. 
	
	%definicao de monitoramento%
	
	\subsection{Características de ferramentas de monitoramento na nuvem}
	
	Segundo \citeonline{aceto2012cloud} existem 11 características que uma ferramenta de monitoramento na nuvem deve possuir para ter um funcionamento correto e sem degradar os serviços fornecidos:
	\begin{enumerate}
		\item Escalabilidade: a ferramenta pode ser considerada escalável se ela consegue suportar uma larga quantidade de objetos a serem monitorados \cite{clayman2010monitoring}. Na nuvem, tal característica tem importância devida a grande gama de componentes que podem existir;
		\item Elasticidade: para uma ferramenta ser considerada elástica, ela deve conseguir suportar mudanças ocorridas no ambiente monitorado, tais como novos objetos para serem monitorados ou objetos deixando de ser monitorados \cite{clayman2010monitoring}. Isto é de fundamental importância para ambientes de nuvem, pois o ambiente vive em contínua mudança com a adição e remoção de recursos dinamicamente;
		\item {Adaptabilidade: uma ferramenta de monitoramento é adaptável, se ela consegue se ajustar a mudanças de cargas impostas ao ambiente sem que este seja penalizado e mantendo o seu serviço de monitoramento ativo e funcionando corretamente \cite{clayman2010monitoring}. Para realizar o monitoramento do ambiente, a ferramenta consome recursos de rede, armazenamento e processamento. A ferramenta deve se ajustar para consumir menos recursos em ocasiões que o ambiente se encontra sobrecarregado;}
		\item Pontualidade: a ferramenta pode ser considerada pontual, se ela é capaz de relatar eventos que acontecem no ambiente, como perda repentina de um recurso, ou sobrecarga de outro, em tempo hábil para estes serem tratados \cite{wang2011flexible};
		\item Autonomia: para a ferramenta ser considerada autônoma, ela deve ser capaz de se gerenciar, conseguindo responder a mudanças repentinas do ambiente sem a necessidade de uma outra entidade a supervisionando. Ao mesmo tempo em que torna a complexidade do seu funcionamento discreta para usuários e gerentes do ambiente;
		\item Abrangente: uma ferramenta de monitoramento é abrangente, se ela consegue monitorar diferentes tipos de recursos e capturar diferentes métricas destes recursos \cite{hasselmeyer2010towards}. Isto é importante, já que ambientes de nuvem costumam ser heterogêneos;
		\item Extensividade: a ferramenta pode ser considerada extensível, se ela suporta a adição de novas métricas para monitorar, sem a necessidade de modificações no código fonte da ferramenta.
		\item Não intrusiva: para a ferramenta não ser considerada intrusiva, ela deve poder ser implantada no ambiente sem precisar de modificações significativas deste \cite{katsaros2011building};
		\item Confiabilidade: uma ferramenta de monitoramento é dita confiável, se mesmo com falhas em diversos componentes, ela ainda continua fornecendo seu serviço normalmente com os componentes que ainda lhe restam \cite{laprie2008dependability};
		\item Disponibilidade: a ferramenta de monitoramento deve estar disponível sempre que os seus serviços forem solicitados. Isto é importante para ambientes da nuvem, pois estes estão em constante atividade \cite{shirey2007internet};
		\item Precisão: a ferramenta é considerada precisa se as informações disponibilizadas pela ferramenta contem valores que expressem o mais aproximadamente possível o estado em que o objeto monitorado se encontra no momento que a medida foi realizada. 
		
	\end{enumerate}
	
	Além das características levantadas por \cite{aceto2012cloud}, também são apontadas algumas dificuldades na área de monitoramento da nuvem.
	\begin{itemize}
		
		
		\item{Grande volume de informação:}
		a nuvem possui diversos usuários, assim como componentes e um grande tráfego de rede. Com isso, algumas horas de monitoramento contínuo, podem gerar Tera Bytes de informações para serem armazenadas; 
		
		\item{Mudança constante do ambiente:}
		devida a elasticidade de um ambiente de computação em nuvem, as métricas a serem monitoradas podem mudar a qualquer momento, pode haver a necessidade de monitorar um novo elemento que não estava previsto; 
		
		\item{Sensibilidade de ambientes carregados:}
		em ambientes de computação em nuvem muito carregados, a presença do monitoramento pode acarretar em sobre carga de processamento, e acabar comprometendo o funcionamento de todo o ambiente;
		
		\item{Garantir autonomia da ferramenta:}
		esta demanda a possível exis-tência de um laço que irá receber informações do ambiente de tempos em tempos (a própria ferramenta que deve obter essas informações), processar essas informações e repassar as ações que cada nodo deve executar (no caso de uma ferramenta distribuída). Deve-se realizar este processo tentando gerar o menor impacto possível no ambiente;
		
		\item{Heterogeneidade do ambiente:}
		 ambiente de computação em nuvem possui inúmeros dispositivos com diferentes arquiteturas e tecnologias. Deve-se conseguir prover suporte de monitoramento para cada um desses dispositivos e ainda manter um bom isolamento entre eles;
		
		\item{Rastreamento de elementos da nuvem:}
		o ambiente de nuvem permite que seus recursos sejam migrados de um dispositivo físico para outro. Deve-se garantir que a ferramenta consiga detectar a nova localização de um recurso migrado e continuar monitorando este recurso em sua nova localização, em vez de apenas acusar uma falta do recurso em um local e a detecção de um novo recurso em outro.
		
	\end{itemize}
	
	O monitoramento na nuvem é de grande importância tanto para os clientes quanto para os fornecedores de serviços na nuvem. O monitoramento é um meio para se garantir um melhor controle dos dispositivos de hardware e das aplicações que são executadas nos ambientes de nuvem \cite{aceto2012cloud}. 
	
	O constante monitoramento do ambiente, auxilia na garantia da qualidade do serviço prestado para os usuários do ambiente, como por exemplo: disponibilidade e tempo de resposta das aplicações hospedadas. Para os fornecedores de serviços, o monitoramento é um modo de mensurar os recursos utilizados pelo usuário e então poder ser cobrada uma taxa referente ao uso dos mesmos \cite{aceto2012cloud}. Para ambos os casos, o monitoramento auxilia na prevenção e até mesmo correção de desvios no termo de prestação de serviços acordado por usuário e provedor \cite{aceto2012cloud}.   
	
	
	\subsection{Ferramentas de monitoramento}
	
	Nesta seção serão descritas ferramentas de monitoramento de código aberto que são comumente usadas para monitorar ambientes de computação em nuvem.
	
	\begin{itemize}
		
		\item Nagios: o Nagios \cite{nagios2015} suporta o monitoramento de máquinas virtuais e serviços de armazenamento \cite{caron2012auto}. O Nagios é uma ferramenta de código aberto que possui inúmeras extensões. Existem extensões que possibilitam o Nagios monitorar sistemas como Eucalyptus, CloudStack\cite{CSnagios2015} e OpenStack \cite{OSnagios2015};
		
		\item Zenoss: O Zenoss \cite{zenoss2015} é uma ferramenta opensource escrita em Java com suporte a diversos virtualizadores, como por exemplo, KVM, XenServer e VMware. Usuários do CloudStack, tem a possibilidade de usar o Zenoss ao instalar a extensão \cite{CSzenPack2015}, usuários de OpenStack podem usar a extensão \cite{OSzenPack2015}.  Estas extensões ficam limitadas pelas funcionalidades disponibilizadas através das APIs das ferramentas de orquestração;
		
		\item Nimbus: a Nimbus \cite{nimbus2015} é uma ferramenta de criação e gerência de ambientes de computação em nuvem, Suporta virtualizadores como Xen ou KVM e da suporte para monitoramento do ambiente através do protocolo SNMP\cite{snmp2015}. Esta ferramenta é voltada especialmente para projetos relacionados a comunidade científica. A Nimbus visa autonomia no monitoramento tanto de aplicações do ambiente quanto na infraestrutura como um todo, no caso, ela não suporta monitoramento de clusters, apesar de monitorar aplicações sendo executadas nas VMs. 
		
		\item Zabbix: o Zabbix \cite{zabbix2015} é uma ferramenta de monitoramento de infraestrutura e aplicações. Esta ferramenta da suporte para abordagens multi agente ou sem nenhum agente (centralizado). Esta ferramenta é compatível com vCenter \cite{vCenter2015} permitindo monitoramento destes ambientes. Além de ser compatível com o vCenter, o Zabbix permite o monitoramento de qualquer dispositivo de hardware que suporte IPMI \cite{IPMI2015} e dispositivos que suportem SNMP, conseguindo capturar as mesmas métricas suportadas por ambos os protocolos IPMI e SNMP. Usuários de CloudStack podem usar o Zabbix através a extensão \cite{zabbix-cloudstack2015} e usuários de OpenStack através da extensão \cite{zabbix-openstack2015} 
		
		\item Icinga: o Icinga \cite{icinga2015} é uma ferramenta que pode ser instalada em qualquer distribuição Linux. Nesta ferramenta, o usuário deve especificar o que deve ser monitorado antes de inicializar a ferramenta, ou seja, qualquer novo item a ser monitorado, irá requerer uma reinicialização da ferramenta. Assim como o Nagios, esta ferramenta promete uma fácil extensibilidade, possibilitando que os usuários criem plugins para expandir o funcionamento da ferramenta, além de suportar todos os plugins desenvolvidos para o Nagios. Esta ferramenta monitora serviços de rede e consumo de recursos de hardware, como CPU e memória. Ela possui uma extensão para usuário do OpenStack \cite{icingaOpenstack2015}, usuários de CloudStack não tem suporte ainda para uso do Icinga e acabam adotando o Nagios como substituto já que ambas as ferramentas são similares.
	\end{itemize}
	
	\begin{table}[h]
		\centering
		\caption{Características suportadas pelas ferramentas analisadas}
		\label{comparacaoFerramentas}
		\begin{tabular}{|l|c|c|c|c|c|}
			\hline
			& \multicolumn{1}{l|}{Nagios} & \multicolumn{1}{l|}{Zenoss} & \multicolumn{1}{l|}{Nimbus} & \multicolumn{1}{l|}{Zabbix} & \multicolumn{1}{l|}{Icinga} \\ \hline
			Escalabilidade  &                             &                             &                             &                             &                             \\ \hline
			Elasticidade    &                             &                             &                             &                             &                             \\ \hline
			Adaptabilidade  &                             &                             &                             &                             &                             \\ \hline
			Pontualidade    &                             & X                           &                             & X                           &                             \\ \hline
			Autonomia       &                             &                             & X                           &                             &                             \\ \hline
			Abrangencia     &                             &                             &                             &                             &                             \\ \hline
			Extensividade   & X                           &                             &                             & X                           & X                           \\ \hline
			Não intrusiva   &                             &                             &                             &                             &                             \\ \hline
			Confiabilidade  &                             &                             &                             & X                           &                             \\ \hline
			Disponibilidade &                             &                             &                             &                             &                             \\ \hline
			Precisão        &                             &                             &                             &                             &                             \\ \hline
		\end{tabular}
	\end{table}
	

	Dentre as ferramentas analisadas, todas suportam monitoramento de recursos de hardware usando protocolos padrões de monitoramento como SNMP e IPMI, além de usar estes protocolos, usam também APIs (Interface de programação de aplicações) de ferramentas de orquestração. Uma característica em comum dessas ferramentas, é a abordagem de coletar os dados e armazená-los de modo histórico. Todas usam o mesmo conceito de ter uma entidade centralizada que de tempos em tempos, envia mensagens para os nodos que estão nos servidores físicos coletarem os dados e enviarem para o nó central. 
	
	Como mostrado na tabela \ref{comparacaoFerramentas}, as ferramentas analisadas não dão suporte a inúmeras das características abortadas em \cite{aceto2012cloud}, isso se deve pelo fato de que as ferramentas em si não interagem diretamente com os Virtualizadores dos ambientes de computação em nuvem e sim com APIs das ferramentas de orquestração. Essas APIs por muitas vezes são incompletas e inconsistentes. Outro ponto que as ferramentas adotam é a inserção de agentes dentro das máquinas virtuais para coletar os dados de cada máquina virtual e então juntar esses dados para obter as métricas de todo o ambiente, o que torna a ferramenta intrusiva.
	
	A proposta deste trabalho será de criar uma ferramenta que suporte essas características. A ferramenta irá usar chamadas de sistema dos Virtualizadores para conseguir obter os dados dos ambientes em vez de usar APIs das ferramentas de orquestração. Outra abordagem diferente da ferramenta proposta neste trabalho, será uma inversão do paradigma adotado pelas ferramentas analisadas, que é o fato de um nodo central fazer requisições para os nodos folhas coletarem os dados e retornarem estes para o nodo central. A proposta deste trabalho consiste em os nodos folhas enviarem periodicamente os dados coletados para o nodo central sem o nodo central precisar requisitar, isso gera um menor fluxo de rede e torna a ferramenta menos impactante para o ambiente. 
	
	\chapter{Trabalhos relacionados}
	
	Este capitulo aborda sobre modelos de monitoramento de ambientes de computação em nuvem, pontos fortes e fracos de cada modelo, e por fim, uma comparação entre os modelos apresentados e o modelo proposto neste trabalho.
	
	Em \cite{katsaros2012self} é proposto um modelo para monitorar todas as camadas (aplicação, plataforma e infraestrutura) de um ambiente de computação em nuvem. O modelo consiste de 6 componentes constituindo a ferramenta de monitoramento como um todo, cada componente é descrito a seguir:
		\begin{itemize}
			\item Framework de serviço de monitoramento: é o principal componente, responsável por orquestrar os outros componentes e disponibilizar os resultados do monitoramento para o usuário;
			\item Repositório central: responsável por organizar e guardar todos os dados do monitoramento;
			\item Serviço de monitoramento de infraestrutura: responsável por obter dados do uso de recursos da infraestrutura;
			\item Serviço de monitoramento de instancia: responsável por obter dados do uso de recursos de cada VM de um servidor através do coletor de dados e guardar no repositório central;
			\item Repositório local: responsável por armazenar os dados de monitoramento de uma única VM;
			\item Coletor de dados: coleta os dados de uso de recursos de uma única VM e guarda no repositório local.
		\end{itemize}
	
	Principais características abordadas no modelo de \cite{katsaros2012self} é a elasticidade e acurácia, o modelo permite reconfigurar todas as métricas de monitoramento sem a necessidade de reiniciar o sistema ou proporcionar algum impacto de desempenho para o ambiente. Principal problema encontrado, cada instancia de máquina virtual irá gerar uma instancia de coletor de dados e repositório local, o que gera um uso extra de memória, sem falar que é uma solução invasiva, pois insere software dentro da VM do usuário.
	
	\citeonline{andreozzi2005gridice} propõem um modelo de monitoramento de serviços distribuídos. O modelo proposto é dividido em 5 módulos independentes para facilitar extensões e manutenção. É apresentado um módulo de coleta de dados que usa sensores (o tipo de sensor ou como são implementados não é especificado) para medir trafego de rede, desempenho do serviço monitorado, disponibilidade do mesmo e uso de recursos físicos. O segundo módulo é o responsável por analisar quais dados são mais interessantes para cada tipo de serviço, para tal fim foi usado o Globus MDS \cite{globus2015} para fazer a análise dos dados capturados e classificá-los . O terceiro módulo armazena cada tipo de dados em uma base de dados relacional, no caso o postgreSQL \cite{postgre2015}. O quarto módulo serve para informar quando algum serviço está sobrecarregado/inacessível. E o ultimo módulo é responsável pela apresentação dos dados através de uma página web.
	
	Este modelo foi feito com intenção de monitorar serviços web e informar aos usuários as condições de cada serviço. O banco de dados para persistência dos dados separa cada tipo de dado em tabelas diferentes para agilizar consultas. O diferencial deste modelo é o fato de conseguir peneirar os dados não relevantes para cada tipo de serviço e não armazenar tal dado, porem ele ainda continua monitorando tal tipo de dado.
	
	O modelo apresentado por \cite{andreozzi2005gridice} permite adições de novos módulos e métricas de monitoramento, sendo que novos módulos requerem a reinicialização do sistema e novas métricas não precisam de reinicialização. Usa banco de dados relacional para persistir os dados e persiste apenas dados considerados relativos. A visualização dos dados pode ser feita usando um histórico de 1, 5 e 15 minutos, históricos superiores a esses intervalos não são descartados.
	
	\citeonline{shao2010runtime} propõem um modelo de monitoramento baseado em agentes que opera em todas as camadas de computação em nuvem e tem como principal característica balancear a capacidade de monitoramento da ferramenta com o aumento ou redução da carga dos servidores, de modo a ajustar a coleta de dados baseado na carga do ambiente. A ferramenta realiza isso medindo a carga do ambiente e ajustando a frequência de obtenção dos dados, ambiente pouco carregado, aumenta a frequência e vice-versa.
	
	Para realizar a coleta de dados de cada VM, são instanciados agentes (Aplicações Java), dentro de cada máquina virtual, ou seja, cada máquina virtual vai ter uma JVM executando um agente para obter os dados da VM. Este agente por sua vez, utiliza uma biblioteca nativa escrita em C \cite{sigar2015}.
	
	O balanceamento da carga do ambiente com a coleta de dados da ferramenta ocorre de modo manual, usando uma ferramenta do Java 6 \textit{hotswap} que permite trocar uma classe java por uma outra versão dessa mesma classe em tempo de execução, assim se torna possível alterar os agentes em tempo de execução de forma a possibilitar um melhor controle de consumo de recursos pela ferramenta. A persistência dos dados ocorre num banco de dados relacional onde não são separados tipos de dados como no trabalho anterior. 
	
	\begin{table}[]
		\centering
		\caption{Comparação dos Trabalhos relacionados}
		\label{compTrabRela}
		\begin{tabular}{|L{2cm}|L{2cm}|L{2cm}|L{2cm}|}
			\hline
			& \cite{katsaros2012self} & \cite{andreozzi2005gridice} & \cite{shao2010runtime}        \\ \hline
			Modo de guardar dados                           & Banco relacional          & Banco relacional              & Banco relacional                \\ \hline
			Mantém histórico de dados                       & Sim                       & Por no máximo 15 min          & Sim                             \\ \hline
			Filtro de métricas                              & Não                       & Sim                           & Não                             \\ \hline
			Área de atuação                                 & IaaS, PaaS e SaaS         & Serviços distribuidos         & IaaS, PaaS e SaaS               \\ \hline
			Modo de obtenção dos dados                      & Script injetado nas VMs   & Sensores                      & Aplicação Java injetada nas VMs \\ \hline
			Permite ajustar intervalo de exibição dos dados & Não                       & Sim                           & Não                             \\ \hline
		\end{tabular}
	\end{table}
	
	Dentre os trabalhos analisados, todos optam por uma abordagem de banco de dados relacional para a persistência dos dados coletados, talvez uma abordagem não relacional seja mais adequada para esse tipo de problema pois bancos não relacionais tendem a se tornar mais rápidos que relacionais quando o volume de dados se torna grande. Uma diferenca desses trabalhos em relação as ferramentas mostradas, é o fato que eles propõem um modelo em que os dados coletados por cada nodo são enviados para um repositório periodicamente em vez de uma entidade central solicitar que tais nodos enviem os dados, como é feito nas ferramentas analisadas. Além disso, um problema encontrado nos modelos propostos é o fato de como eles obtém os dados das máquinas virtuais. Usando métodos invasivos de inserção de scripts ou aplicações dentro das máquinas virtuais dos usuários, além desses métodos serem invasivos, eles são pouco práticos, pois acabam ficando presos ao sistema operacional que o usuário escolher, um script para obter dados num Unix por exemplo, vai ser diferente do script de um Windows.
	
	Além disso, como mostrado na Tabela 4 todas as propostas tendem a manter um histórico dos dados armazenados, porém não disponibilizam um meio de configurar por quanto tempo o usuário gostaria que os dados ficassem armazenados. Outra coisa apontada na Tabela 4 é o uso de um filtro de métricas pela proposta de \cite{andreozzi2005gridice} que permite otimizar a coleta de dados do ambiente sem deixar de capturar a essência do comportamento do mesmo. 
	
	\chapter{Proposta}
	
	Conforme apresentado por Aceto et al. em \cite{aceto2012cloud}
	o cenário de ferramentas de monitoramento para ambientes de computação em nuvem não atende as necessidades de gerência, seja por
	falta de precisão nos resultados do monitoramento, falta de extensibilidade da aplicação ou o fato de injetarem código nas máquinas virtuais
	dos usuários.
	A proposta deste trabalho consiste na criação de uma plataforma de monitoramento de ambientes de computação em nuvem que possa
	atender às características de monitoramento elencadas em \cite{aceto2013cloud} de modo autônomo e sem prejudicar o ambiente e usuários. Deste	modo, será utilizada uma arquitetura orientada a serviços, onde cada	serviço é responsável por garantir uma funcionalidade da ferramenta, sendo possível a adição de novos serviços em tempo de execução para complementar a plataforma de monitoramento de ambientes de computação em nuvem em nível de IaaS. Além disso, o uso de agentes para realizar a configuração autônoma do componente de monitoramento, permite que a plataforma se ajuste autonomamente ao comportamento do ambiente, possibilitando um melhor uso de recursos.

\section{ARQUITETURA DA PLATAFORMA DE MONITORAMENTO}
	
	As ferramentas de orquestração de ambientes de computação em
	nuvem possuem 5 elementos básicos como descrito em \cite{tccgabriel2015}
	
	\begin{itemize}
		\item Gerente de identidades - é responsável por definir quais privilégios sobre cada recurso do ambiente cada usuário possui;
		\item Gerente de alocação - trata da alocação de máquinas virtuais para os usuários assim que estas são solicitadas;	
		\item Componente virtualizador - intermedeia a comunicação entre diferentes tipos de virtualizadores e a ferramenta de orquestração;
		\item Componente de armazenamento - efetua o gerenciamento e compartilhamento de imagens das máquinas virtuais entre servidores
		do ambiente;
		\item Componente de rede - responsável por toda a configuração de rede do ambiente.
	\end{itemize}
	
	A plataforma proposta neste trabalho pode ser vista como um sexto elemento da ferramenta de orquestração que será a responsável por gerenciar o monitoramento das máquinas virtuais e servidores do ambiente. Ao fim da implantação da plataforma de monitoramento, a distribuição dos elementos que compõe a ferramenta de orquestração ficará como ilustrado na Figura 1.
	
	\begin{figure}[h]
		
		
		\centering
		\includegraphics[scale=1]{figuras/ferramentaOrquestracao.png} % leia abaixo
		\label{figura:ferramentaOrquestracao}
		\caption{Ferramenta de orquestração estendida com a plataforma
			autônoma de monitoramento}
	\end{figure}
	
	\section{COMPONENTES DA PLATAFORMA DE MONITORAMENTO}
	
	Nesta sessão sã descritos os elementos existentes na plataforma
	de monitoramento, como eles são constituídos e qual papel de cada um.
	Ilustrada na Figura 2, a plataforma de monitoramento é composta de
	3 componentes, o componente de monitoramento, de configuração e de
	armazenamento que são descritos nas subseções que se seguem.
	
	\subsection{Componente de Monitoramento}
	
	Este componente é responsável por coletar os dados referentes ao
	consumo de recursos de cada máquina virtual e servidores do ambiente
	em que ele foi designado para atuar. Este componente é constituído de
	um ou mais serviços de captura de dados que podem monitorar as mesmas ou diferentes métricas como ilustrado na Figura 3 Cada serviço de
	captura poderá a coletar uma ou mais variáveis do ambiente, poderão haver múltiplas instâncias do mesmo serviço no ambiente, monitorando
	o mesmo conjunto de métricas de servidores e máquinas virtuais diferentes, assim como também poderão haver diferentes serviços que	monitoram conjuntos de métricas distintos.
	
		\begin{figure}[h]
			
			
			\centering
			\includegraphics[scale=1]{figuras/ambienteComPlataforma} % leia abaixo
			\label{figura:ambienteComFerramenta}
			\caption{Ambiente de computação em nuvem com a plataforma de monitoramento}
		\end{figure}
		
		\begin{figure}[h]
			
			
			\centering
			\includegraphics[scale=1]{figuras/componenteMonitoramento} % leia abaixo
			\label{figura:componenteMonitoramento}
			\caption{Componente de monitoramento}
		\end{figure}
		
		
		
		
	
	\bibliographystyle{ufscThesis/ufsc-alf}
	\bibliography{bibliografia}
	
	%--------------------------------------------------------
	% Elementos pós-textuais
	
\end{document}
